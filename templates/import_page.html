{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <!-- navigation things-->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <!-- Bootstrap -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <!-- FontAwesome -->
        <script src="https://kit.fontawesome.com/5dc39887b7.js" crossorigin="anonymous"></script>
        
        {# <script type="text/javascript" src="/static/js/jquery.js"></script>#}

        </head>
<body>
<!--upload section start-->
<!--start of navbar-->
    <div class="col-12">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">OurLogo</a>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'import' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id %}" tabindex="-1" aria-disabled="true"><strong>匯入</strong></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'check_page' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id %}" tabindex="-1" aria-disabled="true"><strong>檢查</strong></a>
{#                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">#}
{#                                <a class="dropdown-item" href="#">定期存款</a>#}
{#                                <a class="dropdown-item" href="#">銀行存款</a>#}
{#                            </div>#}
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link" href="{% url 'adjust_acc' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id %}" id="navbarDropdown" role="button"
                               aria-haspopup="true" aria-expanded="false">調整</a>
{#                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">#}
{#                                <a class="dropdown-item" href="#">定期存款調整科目</a>#}
{#                                <a class="dropdown-item" href="#">銀行存款調整外幣評價損益</a>#}
{#                                <a class="dropdown-item" href="#">調整表</a>#}
{#                                <a class="dropdown-item" href="#">附註格式</a>#}
{#                            </div>#}
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'disclosure_page' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id %}" tabindex="-1" aria-disabled="true">附註格式</a>
                        </li>
                    </ul>
                    <form class="form-inline my-2 my-lg-0">
                        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                    </form>
                    <div class="other_nav_buttons">
                        <i class="fas fa-cog"></i>
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </nav>
    </div>
<!--end of navbar-->
<div class="container-fluid" >
    <div class="row">
    <!-- start tree -->
    <div class="col-md-2 pt-5">
        <div id="tree">

        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
        <script src="{% static 'js/bstreeview.js' %}">
    </script>
    <script>
        $(function () {

            var json = '[' +
                '{' +
                '"text": "資產",' +
                '"icon": "fa fa-inbox",' +
                '"nodes": [' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}, ' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}' +
                ']' +
                '},' +
                '{' +
                '"text": "負債",' +
                '"icon": "fa fa-inbox",' +
                '"nodes": [' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}, ' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}' +
                ']' +
                '},' +
                '{' +
                '"text": "權益",' +
                '"icon": "fa fa-inbox",' +
                '"nodes": [' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}, ' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}' +
                ']' +
                '},' +
                '{' +
                '"text": "損益",' +
                '"icon": "fa fa-inbox",' +
                '"nodes": [' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}, ' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}' +
                ']' +
                '},' +
                '{' +
                '"text": "其他",' +
                '"icon": "fa fa-inbox",' +
                '"nodes": [' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}, ' +
                '{' +
                '"icon": "fa fa-inbox",' +
                '"text": "Others"' +
                '}' +
                ']' +
                '}' +
                ']';

            $('#tree').bstreeview({ data: json });

        });
    </script>
    <!-- endof tree-->
        <br>
        <div class="col-8">
            <!--如果沒上傳過定期存款，顯示這個-->
            {% if  count_Depositaccount_list.0 == 999 %}
            <div class="row justify-content-start">
                <div class="col-2 align-self-center">定期存款：</div>
                <div class="col-6">
                    {#              '{% url "upload_file" comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name="deposit_account" %}'#}

                    <form action='./import' method="post" enctype="multipart/form-data">
                        <div class="custom-file" style="width: 80%">
                            <input type="text" hidden name="table_name" value="deposit_account"/>
                            <input type="file" accept=".xls, .xlsx" class="custom-file-input" id="UploadDepositAccount"
                                name='file'/>
                            <label class="custom-file-label text-left" for="customFile"></label>
                        </div>
                        <input class="btn btn-primary" type="submit"/>
                    </form>
                </div>
            </div>
            {% endif %}
            
            <!--如果上傳過定期存款，顯示這個 789-->
            {% if count_Depositaccount_list.0 == 789  %}
            <div class="row justify-content-start">
                    <div class="col-2 align-self-center">定期存款：</div>
                    <div class="col-2 align-self-center">
                        <button class="btn btn-primary" id="del_Depositaccount">del</button> 
                    </div>
                    </div>
            {% endif %}

            <!--如果沒上傳過銀行存款，顯示這個-->
            {% if  count_CashInBank_list.0 == 456 %}
            <div class="row justify-content-start">
                

                    <div class="col-2 align-self-center">銀行存款：</div>
                    <div class="col-6">
                        {#              '{% url "upload_file" comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name="deposit_account" %}'#}
                        <form action='./import' method="post" enctype="multipart/form-data">
                            <div class="custom-file" style="width: 80%">
                                <input type="text" hidden name="table_name" value="cash_in_bank"/>
                                <input type="file" accept=".xls, .xlsx" class="custom-file-input" id="UploadCashInBank"
                                    name='file'/>
                                <label class="custom-file-label text-left" for="customFile"></label>
                            </div>
                            <input class="btn btn-primary" type="submit"/>
                        </form>
                    </div>
                    </div>
            {% endif %}
            
            <!--如果上傳過銀行存款，顯示這個-->   
            {% if count_CashInBank_list.0 == 123 %}
            <div class="row justify-content-start">
                    <div class="col-2 align-self-center">銀行存款：</div>
                    <div class="col-2 align-self-center">
                    <button class="btn btn-primary" id="del_CashInBank" >del</button>
                    </div>
                    </div>
            {% endif %}
            {% if import_related_list.count != 0 and import_related_list.0 != 200 %}
                <div class="row justify-content-center">
                    <div class="col-8">上傳失敗，原因：{{ import_related_list.1 }}</div>
                </div>
            {% endif %}

            {% if import_related_list.count != 0 and import_related_list.0 == 200 %}
                <div class="row justify-content-center">
                    <div class="col-4 align-self-center">您已成功上傳</div>
                </div>
            {% endif %}
        </div>
    </div> 
</div>
<!--upload section end-->
<!-- </div> -->
<!-- </div> -->


<!-- <div class="row">
  <div class="col-md-1">定期存款：</div>
  <div class="col-md-4">
    <form method="post" enctype="multipart/form-data">
      <div class="custom-file" style="width: 80%">
        <input type="file" accept=".xls" class="custom-file-input" id="UploadCashInBank"></input>
        <label class="custom-file-label text-left" for="customFile"></label>
      </div>
      <input type="submit"></input>
    </form>
  </div>
  <div class="col-md-1">
    <form>
      <button><a href="'companies/<int:comp_id>/projects/<int:rpt_id>/accounts/<int:acc_id>/raw_files/Cashinbanks'"></a>刪除</a></button>
    </form>
  </div>
</div> -->


<!--upload documents-->


<script type="text/javascript">
    $(document).ready(function() {

        {% if count_Depositaccount_list.0 == 999 %}
            document.getElementById("UploadDepositAccount").addEventListener('change', function (e) {
                var fileName = document.getElementById("UploadDepositAccount").files[0].name;
                var nextSibling = e.target.nextElementSibling
                nextSibling.innerText = fileName
            })
        {% endif %}

        {% if count_CashInBank_list.0 == 789 %}
            document.getElementById("UploadCashInBank").addEventListener('change', function (e) {
                var fileName = document.getElementById("UploadCashInBank").files[0].name;
                var nextSibling = e.target.nextElementSibling
                nextSibling.innerText = fileName
            })
        {% endif %}

        $("#del_CashInBank").on('click',function () {
                {#alert(" {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='cash_in_banks' %}");#}
                var statu = confirm("確定要刪除銀行存款嗎?");
                if (!statu) { return false; }
                $.ajax({
                    type: "GET",
                    url: " {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='cash_in_banks' %}",
                    //data: "BookID=" + $(this).next().val(),
                    //dataType: "json",
                    success: function (response) {
                        {#window.location.reload();#}
                        console.log(response)
                    }, error: function (error) {
                        {#window.location.reload();#}
                        console.log(error);
                    },
                    complete: function(XMLHttpRequest, textStatus) {
                        window.location = window.location.href;
                    }
                });
        });

        $("#del_Depositaccount").on('click', function () {
            console.log('in')
                {#alert(" {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='deposit_account' %}");#}
                var statu = confirm("確定要刪除銀行存款嗎?");
                if (!statu) { return false; }
                $.ajax({

                    type: "GET",
                    url: " {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='deposit_account' %}",
                    //data: "BookID=" + $(this).next().val(),
                    //dataType: "json",
                    success: function (response) {
                        {#window.location.reload();#}
                    }, error: function (error) {
                        {#window.location.reload();#}
                        console.log(error);
                    },
                    complete: function(XMLHttpRequest, textStatus) {
                        window.location = window.location.href;
                    }
                });
        });


        $("#del_CashInBank").on('click',function () {
                {#alert(" {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='cash_in_banks' %}");#}
                var statu = confirm("確定要刪除銀行存款嗎?");
                if (!statu) { return false; }
                $.ajax({

                    type: "GET",
                    url: " {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='cash_in_banks' %}",
                    //data: "BookID=" + $(this).next().val(),
                    //dataType: "json",
                    success: function (response) {
                        window.location.reload();
                    }, error: function (error) {
                        window.location.reload();
                        console.log(error);
                    }
                });
        });

        $("#del_Depositaccount").click(function () {
                {#alert(" {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='deposit_account' %}");#}
                var statu = confirm("確定要刪除銀行存款嗎?");
                if (!statu) { return false; }
                $.ajax({

                    type: "GET",
                    url: " {% url 'delete_file' comp_id=comp_id rpt_id=rpt_id acc_id=acc_id table_name='deposit_account' %}",
                    //data: "BookID=" + $(this).next().val(),
                    //dataType: "json",
                    success: function (response) {
                        window.location.reload();
                    }, error: function (error) {
                        window.location.reload();
                        console.log(error);
                    }
                });
        });
   
    var search = function(e) {
    var pattern = $('#input-search').val();
    var options = {
        ignoreCase: $('#chk-ignore-case').is(':checked'),
        exactMatch: $('#chk-exact-match').is(':checked'),
        revealResults: $('#chk-reveal-results').is(':checked')
    };

    var output = '<p>' + results.length + ' matches found</p>';
    $.each(results, function (index, result) {
        output += '<p>- ' + result.text + '</p>';
    });
    $('#search-output').html(output);
    }
    $('#btn-clear-search').on('click', function (e) {
    $('#input-search').val('');
    $('#search-output').html('');
    });
    })




{#    $(function() {#}
{##}
{##}
//{#});#}
</script>
</body>
</html>